# Bật RewriteEngine
RewriteEngine On

# Xác định thư mục cơ sở
RewriteBase /

# Xử lý lỗi 404 và 403
ErrorDocument 404 /error.php?code=404
ErrorDocument 403 /error.php?code=403
ErrorDocument 500 /error.php?code=500

# Không hiện thị danh sách thư mục
Options -Indexes

# Bảo vệ một số tệp quan trọng
<FilesMatch "^(\.htaccess|\.htpasswd|config\.php|db_setup\.php)">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Thêm bảo mật cơ bản
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
    Header always append X-Frame-Options SAMEORIGIN
</IfModule>

# PHP cài đặt bảo mật
php_flag display_errors off
php_value post_max_size 8M
php_value upload_max_filesize 2M
php_value max_execution_time 30
php_value max_input_time 60
php_value memory_limit 128M